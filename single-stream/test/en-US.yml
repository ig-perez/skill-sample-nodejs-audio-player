#=====================================================================================================================
#     ______    _ ____  ______        __  _
#    / __/ /__ (_) / / /_  __/__ ___ / /_(_)__  ___ _
#   _\ \/  '_// / / /   / / / -_|_-</ __/ / _ \/ _ `/
#  /___/_/\_\/_/_/_/   /_/  \__/___/\__/_/_//_/\_, /
#                                             /___/
#
# Created by Bespoken
# Learn more at https://read.bespoken.io/unit-testing/getting-started/
#
# Skill name: "Audio Player Single Stream" by Amazon
# Test scope: LaunchRequest (PlayAudio), AMAZON.PauseIntent, AMAZON.ResumeIntent, AMAZON.HelpIntent
#             AMAZON.CancelIntent, AMAZON.StopIntent, AMAZON.StartOverIntent, AudioPlayer.PlaybackFinished
#             AudioPlayer.PlaybackNearlyFinished, AudioPlayer.PlaybackFailed, SessionEndedRequest
# Description: Tests single stream AudioPlayer skill
#=====================================================================================================================

---
configuration:
  locale: en-US
  dynamo: mock
  userId: mockUserID

---
- test: "Sequence 01. Test scenario: launch request, no further interaction."
- LaunchRequest:
  - response.outputSpeech.ssml: "Welcome to My Radio"
  - response.card.title: "My Radio"
  - response.card.text: "Less bla bla bla, more la la la"
  - response.card.image.largeImageUrl: "https://alexademo.ninja/skills/logo-512.png"
  - response.shouldEndSession: "true"
  - response.directives[0].type: "AudioPlayer.Play"
  - response.directives[0].playBehavior: "REPLACE_ALL"
  - response.directives[0].audioItem.stream.url: "https://s3-eu-west-1.amazonaws.com/alexa.maxi80.com/assets/jingle.m4a"
- stop: "Goodbye"

---
- test: "Sequence 02. Test scenario: launch request, now a returning user"
- LaunchRequest:
  - response.directives[0].audioItem.stream.url: https://audio1.maxi80.com
- stop: "Goodbye"

---
- test: "Sequence 03. Test scenario: Next, Previous and Shuffle intents."
- LaunchRequest:
- next: "This is radio, you have to wait for next track to play."
- previous: "This is radio, you have to wait for next track to play."
- shuffle: "This is radio, you can not do that.  You can ask me to stop or pause to stop listening."
- stop: "Goodbye"

---
- test: "Sequence 04. Test scenario: start over intent."
- LaunchRequest:
- "start over": "This is radio, you can not do that.  You can ask me to stop or pause to stop listening."

---
- test: "Sequence 05. Test scenario: Resume and pause music."
- resume:
  - response.outputSpeech.ssml: "Resuming My Radio"
  - response.directives[0].audioItem.stream.url: "https://audio1.maxi80.com"
- pause: "Goodbye"

---
- test: "Sequence 06. Test scenario: Help intent."
- resume:
- help: "*" # It seems the Help Intent has not been customized in this skill
- stop: "Goodbye"

---
- test: "Sequence 07. Test scenario: Cancel intent."
- resume:
- cancel: "Goodbye"

---
- test: "Sequence 08. Test scenario: AudioPlayer.PlaybackFinished."
- resume:
- AudioPlayer.PlaybackFinished:
  - response: ""

---
- test: "Sequence 09. Test scenario: AudioPlayer.PlaybackNearlyFinished."
- resume:
- AudioPlayer.PlaybackNearlyFinished:
  - response.shouldEndSession: "true"
  - response.directives[0].type: "AudioPlayer.Play"
  - response.directives[0].playBehavior: "REPLACE_ALL"
  - response.directives[0].audioItem.stream.url: "https://audio1.maxi80.com"
  - response.directives[0].audioItem.metadata.title: "My Radio"
  - response.directives[0].audioItem.metadata.subtitle: "Less bla bla bla, more la la la"
  - response.directives[0].audioItem.metadata.art.contentDescription: "My Radio"
  - response.directives[0].audioItem.metadata.art.sources[0].url: "https://alexademo.ninja/skills/logo-512.png"
  - response.directives[0].audioItem.metadata.backgroundImage.contentDescription: "My Radio"
  - response.directives[0].audioItem.metadata.backgroundImage.sources[0].url: "https://alexademo.ninja/skills/logo-512.png"

---
- test: "Sequence 10. Test scenario: AudioPlayer.PlaybackFailed."
- resume:
- AudioPlayer.PlaybackFailed:
  - response: ""

---
- test: "Sequence 11. Test scenario: Handles SessionEndedRequest."
- resume:
- SessionEndedRequest:
  - response: undefined

---
- test: "Sequence 12. Test scenario: Handles AMAZON.ShuffleOnIntent."
- resume:
- AMAZON.ShuffleOnIntent:
  - intent: AMAZON.ShuffleOnIntent
  - response.outputSpeech.ssml: "/.*this is radio, you can not do that.*/i"

---
- test: "Sequence 13. Test scenario: Handles AMAZON.ShuffleOffIntent."
- resume:
- AMAZON.ShuffleOffIntent:
  - intent: AMAZON.ShuffleOffIntent
  - response.outputSpeech.ssml: "/.*this is radio, you can not do that.*/i"

---
- test: "Sequence 14. Test scenario: Handles AMAZON.LoopOnIntent."
- resume:
- AMAZON.LoopOnIntent:
  - intent: AMAZON.LoopOnIntent
  - response.outputSpeech.ssml: "/.*this is radio, you can not do that.*/i"

---
- test: "Sequence 15. Test scenario: Handles AMAZON.LoopOffIntent."
- resume:
- AMAZON.LoopOffIntent:
  - intent: AMAZON.LoopOffIntent
  - response.outputSpeech.ssml: "/.*this is radio, you can not do that.*/i"

